{% from "macros/stars-rating.jinja" import stars_rating %}
{% from "macros/pricing.jinja" import pricing %}

<!-- YOU MAY ALSO LIKE Section -->
<div class="related-products-section">
  <div class="related-products-header">
    <h3 class="related-products-title">YOU MAY ALSO LIKE</h3>
    <a href="#" class="view-all-link">View all</a>
  </div>

  <div class="related-products-container">
    <!-- Product Grid -->
    <div class="related-products-grid" id="related-products-slider">
      {% if product.related_products %}
        {% for related_product in product.related_products[:8] %}
          <div class="product-card">
            <div class="product-image-container">
              {% if related_product.images and related_product.images|length > 0 %}
                <img src="{{ related_product.images[0].image.medium }}" 
                     alt="{{ related_product.name }}" 
                     class="product-image"
                     loading="lazy">
              {% else %}
                <div class="product-image-placeholder"></div>
              {% endif %}
              
              <!-- Product badges -->
              <div class="product-badges">
                {% if related_product.badge %}
                  <span class="product-badge {{ related_product.badge|lower|replace(' ', '-') }}">{{ related_product.badge }}</span>
                {% elif related_product.sale_price and related_product.sale_price < related_product.price %}
                  <span class="product-badge sale">SALE</span>
                {% elif related_product.quantity == 0 %}
                  <span class="product-badge out-of-stock">OUT OF STOCK</span>
                {% else %}
                  <span class="product-badge new">NEW</span>
                {% endif %}
              </div>

              <!-- Wishlist button -->
              <button class="wishlist-btn" aria-label="Add to wishlist">
                <i class="bi bi-heart"></i>
              </button>
            </div>

            <div class="product-info">
              <h4 class="product-name">{{ related_product.name.upper() }}</h4>
              
              <!-- Star rating -->
              <div class="product-rating">
                {{ stars_rating(
                  rating=4,
                  total_count=150,
                  show_count=true,
                  icon_type="html",
                  wrapper_class="d-flex align-items-center gap-1"
                ) }}
              </div>

              <!-- Price -->
              {{ pricing(related_product) }}

              <!-- Action button -->
              <div class="product-actions">
                {% if related_product.quantity == 0 %}
                  <button class="btn-product-action out-of-stock" disabled>Out of stock</button>
                {% elif related_product.options %}
                  <button class="btn-product-action select-option">Select option</button>
                {% else %}
                  <button class="btn-product-action add-to-cart">Add to cart</button>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
    
    <!-- Navigation with Progress Bar and Arrows -->
    <div class="slider-navigation">
      <div class="progress-bar">
        <div class="progress-fill" style="width: 25%;"></div>
      </div>
      
      <div class="slider-arrows">
        <button class="slider-arrow slider-arrow-left" aria-label="Previous products" disabled>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="slider-arrow slider-arrow-right" aria-label="Next products">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>